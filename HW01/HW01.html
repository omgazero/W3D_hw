<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>HW01</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Snowstorm/20131208/snowstorm-min.js" type="text/javascript"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

</head>
<body>
  <!--
  <button type="button" onclick="toggleAll()">電源開關</button>
  -->
  <audio id="soundtrack" loop >
    <source src="../media/BGM/Arus_Theme.mp3" type='audio/mp3'>
  </audio>

  <div class="onoffswitch">
    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch">
    <label class="onoffswitch-label" for="myonoffswitch">
        <span class="onoffswitch-inner"></span>
        <span class="onoffswitch-switch"></span>
    </label>
  </div>

  <section >
    <div class="tree one" ></div>
    <div class="tree two" ></div>
    <div class="tree three" ></div>
    <div class="wood"></div>
    <div class="tree_shadow"></div>

    <div class="bulb bulb-1"></div>
    <div class="bulb bulb-2"></div>
    <div class="bulb bulb-3"></div>
    <div class="bulb bulb-4"></div>
  </section>

  <script language="javascript">

    function Lamp(bulbClass){
      var name = '.' + bulbClass;
      var bulbStatus = false;
      /*
      this.toggle = function(){
        bulbStatus = !bulbStatus;
      }
      */

      this.turnOn = function(){
        bulbStatus = true;
      }

      this.turnOff = function(){
        bulbStatus = false;
      }

      this.toggleBlink = function(){

        if(bulbStatus!=false){

            let myVar = Math.floor( Math.random()*70 );
        //    console.log('MyVar' + myVar);
            if( myVar <=10 )
                $(name).css ('background', 'hsl(56, 100%, 50%)');
            else if( myVar >10 && myVar <=20 )
                $(name).css ('background', 'hsl(117, 100%, 67%)');
            else if( myVar >20 && myVar <=30 )
                $(name).css ('background', 'hsl(210, 100%, 67%)');
            else if( myVar >30 && myVar <=40 )
                $(name).css ('background', 'hsl(161, 100%, 67%)');
            else if( myVar >40 && myVar <=50 )
                $(name).css ('background', 'hsl(37, 100%, 67%)');
            else if( myVar >50 && myVar <=60 )
                $(name).css ('background', 'hsl(274, 100%, 67%)');
            else
                $(name).css ('background', 'hsl(0, 100%, 67%)');
        }
        else{
            $(name).css ('background', 'gray');
        }
      }
    }
     $(document).ready(function(){
       $("#myonoffswitch").on('click', function(){
            if ($("#myonoffswitch").is(':checked')) {
              b1.turnOn();
              b2.turnOn();
              b3.turnOn();
              b4.turnOn();
              if(sound != undefined)
                  sound.play();
            }
            else{
              b1.turnOff();
              b2.turnOff();
              b3.turnOff();
              b4.turnOff();
              if(sound != undefined)
                  sound.pause()
            }
       });
     });
    /*
    function toggleAll(){
      b1.toggle();
      b2.toggle();
      b3.toggle();
      b4.toggle();
    }
    */

    dutyCycle1 = (Math.random()+0.1)*1000;
    dutyCycle2 = (Math.random()+0.1)*1000;
    dutyCycle3 = (Math.random()+0.1)*1000;
    dutyCycle4 = (Math.random()+0.1)*1000;

    b1 = new Lamp('bulb-1');
    setInterval ( function(){b1.toggleBlink();}, dutyCycle1 );

    b2 = new Lamp('bulb-2');
    setInterval ( function(){b2.toggleBlink();}, dutyCycle2 );

    b3 = new Lamp('bulb-3');
    setInterval ( function(){b3.toggleBlink();}, dutyCycle3 );

    b4 = new Lamp('bulb-4');
    setInterval ( function(){b4.toggleBlink();}, dutyCycle4 );

    var sound = document.getElementById("soundtrack");
    console.log(sound);
    if(sound != undefined){
      sound.volume = 0.2;
    }
  </script>

</body>
</html>
